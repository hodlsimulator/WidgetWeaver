WidgetWeaver – chat handoff (copy/paste)
Last updated: 2026-01-22

Product
- WidgetWeaver is an iOS 26+ app that builds and previews real WidgetKit widgets via an Explore (template catalogue) + context-aware editor workflow.
- Widgets must be deterministic and budget-safe; heavy work (Vision, ranking, photo prep) happens in the app; widgets render from App Group state.

Strategic intent
- “Super complex, super simple”: powerful capabilities under the hood, but progressive disclosure in the UI.
- Ship a coherent flagship set, not a wide permission-heavy grab bag.

Near-term schedule
- Today: 2026-01-22.
- Feature freeze: 2026-01-31 (stop adding features).
- Polish: 2026-02-01 to 2026-02-14.
- Target ship: 2026-02-14 to 2026-02-16.

Current roadmap priorities (pre-freeze)
1) Photos: make Smart Photos + poster/photo widgets feel flagship (fast, reliable, good defaults).
2) Clock: Home Screen correctness and predictable customisation updates.
3) Noise Machine: promote it; keep responsiveness rock-solid; add 1–2 scoped upgrades only.
4) Variables: make them more accessible/discoverable, especially during text editing; surface built-in keys.
5) Reduce surface area and permission footprint (do not break existing widgets):
   - Hide “Reading” from Explore / starter surfaces.
   - Remove the “Photo Quote” template from Explore / starter surfaces.
   - Hide Screen Actions / Clipboard Actions from Explore and first-run paths. Contacts creation is hard-disabled in the auto-detect app intent to avoid a Contacts permission prompt.
   - Keep PawPulse / “Latest Cat” (cat adoption) out of shipped surfaces. The widget is compile-time gated (no gallery presence unless `PAWPULSE` is defined) and background refresh is runtime gated (`WidgetWeaverFeatureFlags.pawPulseEnabled`, default off).

Defer
- Weather: later (post-ship) unless it is already rock-solid; can be hidden/experimental.
- AI: post-ship R&D track; small, reviewable assistive steps; must generate explicit specs/config, not opaque state.

Key repo pointers
- Smart Photos pipeline: WidgetWeaver/SmartPhotoPipeline/*
- Crop editor: WidgetWeaver/SmartPhotoCropEditorView.swift
- Poster background/overlay: Shared/WidgetWeaverSpecView+Background.swift, Shared/WidgetWeaverSpecView.swift
- Home Screen clock widget: WidgetWeaverWidget/WidgetWeaverHomeScreenClockWidget.swift
- Clock live view: WidgetWeaverWidget/Clock/WidgetWeaverClockWidgetLiveView.swift
- Noise Machine widget: WidgetWeaverWidget/WidgetWeaverNoiseMachineWidget.swift
- Template catalogue entries: WidgetWeaver/WidgetWeaverAboutCatalog.swift
- Variable resolution: Shared/WidgetSpec+Utilities.swift, Shared/WidgetSpec+VariableResolutionNow.swift
- Variables UI: WidgetWeaver/WidgetWeaverVariablesView.swift (and related sheets)

Feature removal / hiding pointers
- “Reading” template surfaces: WidgetWeaver/WidgetWeaverAboutCatalog.swift (and any Explore listings)
- “Photo Quote” template: WidgetWeaver/WidgetWeaverAboutCatalog.swift, Shared/WidgetSpec+Utilities.swift (spec helper)
- Screen Actions / Clipboard Actions:
  - Widget: WidgetWeaverWidget/WidgetWeaverClipboardActionsWidget.swift
  - App intents (auto-detect + inbox): WidgetWeaver/WidgetWeaverClipboardInboxIntents.swift (contact creation disabled)
  - Runtime gating helper: Shared/WidgetWeaverFeatureFlags.swift (`clipboardActionsEnabled`, default off)
- PawPulse / “Latest Cat”:
  - Widget registration gate: WidgetWeaverWidget/WidgetWeaverWidgetBundle.swift (`#if PAWPULSE`)
  - Widget: WidgetWeaverWidget/WidgetWeaverPawPulseLatestCatWidget.swift
  - App views/settings: Shared/PawPulseLatestCatDetailView.swift, Shared/PawPulseSettingsView.swift
  - Runtime gating helper: Shared/WidgetWeaverFeatureFlags.swift (`pawPulseEnabled`, default off)
  - Background tasks: Shared/PawPulseBackgroundTasks.swift (runtime gated)

Non-negotiables
- Do not run heavy work in widgets.
- Do not introduce WidgetCenter reload loops from widget providers.
- Do not break existing user widgets when removing templates from Explore.
- Do not ship a build that requests Contacts permission (scope cut: keep Screen Actions surfaces hidden; contact creation remains disabled in the auto-detect app intent).
